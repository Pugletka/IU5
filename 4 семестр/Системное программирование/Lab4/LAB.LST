Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 1
lab.asm



      1				     ; Лабораторная работа №4 (+ дополнительные	требования)
      2	0000			     MYCODE SEGMENT 'CODE'
      3				     ASSUME CS:MYCODE
      4	0000  8B A0 A1 AE E0 A0	E2+  LABTITLE DB 'Лабораторная работа #4$'
      5	      AE E0 AD A0 EF 20	E0+
      6	      A0 A1 AE E2 A0 20	23+
      7	      34 24
      8	0017  80		     CURNTSMBL DB 'А'
      9	0018  30 31 32 33 34 35	36+  HEX_TABLE DB '0123456789ABCDEF'
     10	      37 38 39 41 42 43	44+
     11	      45 46
     12	0028			     START:
     13				     ; Загрузка	сегментного регистра данных DS
     14	0028  0E			  push cs
     15	0029  1F			  pop  ds
     16				     ; Очитка экрана
     17	002A  E8 009A			  call CLRSCR
     18				     ; Вывод заголовка
     19	002D  E8 008C			  call CLRF
     20	0030  BA 0000r			  mov dx , offset LABTITLE
     21	0033  E8 00A0			  call PUTSTR
     22	0036  E8 0083			  call CLRF
     23				     ; Установка количества символов для вывода
     24	0039  B9 000A			  mov cx , 10
     25	003C  E8 00A1			  call PRNTHEAD
     26				     ; Цикл вывода символов
     27	003F			       LOOPCH:
     28	003F  B2 B3			  mov dl , '│'
     29	0041  E8 008D			  call PUTCH
     30	0044  2E: 8A 16	0017r		  mov dl, CURNTSMBL
     31	0049  2E: FE 06	0017r		  inc CURNTSMBL
     32	004E  E8 0080			  call PUTCH
     33	0051  B2 B3			  mov dl, '│'
     34	0053  E8 007B			  call PUTCH
     35	0056  E8 0042			  call HEX
     36	0059  B2 68			  mov dl, 'h'
     37	005B  E8 0073			  call PUTCH
     38	005E  B2 B3			  mov dl , '│'
     39	0060  E8 006E			  call PUTCH
     40	0063  2E: 8A 16	0017r		  mov dl, CURNTSMBL
     41	0068  2E: FE 06	0017r		  inc CURNTSMBL
     42	006D  E8 0061			  call PUTCH
     43	0070  B2 B3			  mov dl, '│'
     44	0072  E8 005C			  call PUTCH
     45	0075  E8 0023			  call HEX
     46	0078  B2 68			  mov dl, 'h'
     47	007A  E8 0054			  call PUTCH
     48	007D  B2 B3			  mov dl , '│'
     49	007F  E8 004F			  call PUTCH
     50	0082  E8 0037			  call CLRF
     51	0085  83 F9 01			  cmp cx , 1 ; Если последний символ, то печатать хвост
     52	0088  74 05		       	  je CONTINUE
     53	008A  E8 0098			  call PRNTSEPRTR
     54	008D  E2 B0			  loop LOOPCH
     55	008F			       CONTINUE:
     56	008F  E8 00D8			  call PRNTTAIL
     57				     ; Ожидание	завершения программы
Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 2
lab.asm



     58	0092  E8 0046			  call GETCH
     59				     ; Вывод из	программы
     60	0095  B0 00			  mov al , 0
     61	0097  B4 4C			  mov ah , 4CH
     62	0099  CD 21			  int 21H
     63
     64				     ; Процедуры:
     65				     ; -------------------------------
     66				     ; Перевод символа в код
     67	009B			     HEX PROC
     68	009B  2E: 8A 16	0017r		 mov dl	, CURNTSMBL
     69	00A0  BB 0018r			 lea bx	, HEX_TABLE ; load data	table.
     70	00A3  8A C2			 mov al	, dl
     71	00A5  D0 E8 D0 E8 D0 E8	D0+	 shr al	, 4 ; leave high part only.
     72	      E8
     73	00AD  D7			 xlat ;	Get hex	digit.
     74	00AE  B4 0E			 mov ah	, 0Eh ;	Teletype sub-function.
     75	00B0  CD 10			 int 10h
     76	00B2  8A C2			 mov al	, dl
     77	00B4  24 0F			 and al	, 0Fh ;	leave low part only.
     78	00B6  D7			 xlat ;	Get hex	digit.
     79	00B7  B4 0E			 mov ah	, 0Eh ;	Teletype sub-function.
     80	00B9  CD 10			 int 10h
     81	00BB  C3			 ret
     82	00BC			     HEX ENDP
     83				     ; -------------------------------
     84				     ; Перевод на новую	строку
     85	00BC			     CLRF PROC
     86	00BC  B2 0A			 mov dl	, 10
     87	00BE  E8 0010			 call PUTCH
     88	00C1  B2 0D			 mov dl	, 13
     89	00C3  E8 000B			 call PUTCH
     90	00C6  C3			 ret
     91	00C7			     CLRF ENDP
     92				     ; -------------------------------
     93				     ; Очистка экрана
     94	00C7			     CLRSCR PROC
     95	00C7  E8 FFF2			 call CLRF
     96	00CA  B4 00			 mov  ah , 0H
     97	00CC  B0 03			 mov  al , 3H
     98	00CE  CD 10			 int  10H
     99	00D0  C3			 ret
    100	00D1			     CLRSCR ENDP
    101				     ; -------------------------------
    102				     ; Вывод одного символа на экран
    103	00D1			     PUTCH PROC
    104	00D1  B4 02			 mov ah	, 02H
    105	00D3  CD 21			 int 21H
    106	00D5  C3			 ret
    107	00D6			     PUTCH ENDP
    108				     ; -------------------------------
    109				     ; Вывод строки
    110	00D6			     PUTSTR PROC
    111	00D6  B4 09			 mov ah	, 09H
    112	00D8  CD 21			 int 21H
    113	00DA  C3			 ret
    114	00DB			     PUTSTR ENDP
Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 3
lab.asm



    115				     ; -------------------------------
    116				     ; Ввод символа с клавиатуры
    117	00DB			     GETCH PROC
    118	00DB  B4 08			 mov ah	, 08H
    119	00DD  CD 21			 int 21H
    120	00DF  C3			 ret
    121	00E0			     GETCH ENDP
    122				     ; -------------------------------
    123				     ; Печать шапки
    124	00E0			     PRNTHEAD PROC
    125	00E0  B2 DA			 mov dl	, '┌'
    126	00E2  E8 FFEC			 call PUTCH
    127	00E5  B2 C4			 mov dl	, '─'
    128	00E7  E8 FFE7			 call PUTCH
    129	00EA  B2 C2			 mov dl	, '┬'
    130	00EC  E8 FFE2			 call PUTCH
    131	00EF  B2 C4			 mov dl	, '─'
    132	00F1  E8 FFDD			 call PUTCH
    133	00F4  B2 C4			 mov dl	, '─'
    134	00F6  E8 FFD8			 call PUTCH
    135	00F9  B2 C4			 mov dl	, '─'
    136	00FB  E8 FFD3			 call PUTCH
    137	00FE  B2 C2			 mov dl	, '┬'
    138	0100  E8 FFCE			 call PUTCH
    139	0103  B2 C4			 mov dl	, '─'
    140	0105  E8 FFC9			 call PUTCH
    141	0108  B2 C2			 mov dl	, '┬'
    142	010A  E8 FFC4			 call PUTCH
    143	010D  B2 C4			 mov dl	, '─'
    144	010F  E8 FFBF			 call PUTCH
    145	0112  B2 C4			 mov dl	, '─'
    146	0114  E8 FFBA			 call PUTCH
    147	0117  B2 C4			 mov dl	, '─'
    148	0119  E8 FFB5			 call PUTCH
    149	011C  B2 BF			 mov dl	, '┐'
    150	011E  E8 FFB0			 call PUTCH
    151	0121  E8 FF98			 call CLRF
    152	0124  C3			 ret
    153	0125			     PRNTHEAD ENDP
    154				     ; -------------------------------
    155				     ; Печать шапки
    156	0125			     PRNTSEPRTR	PROC
    157	0125  B2 C3			 mov dl	, '├'
    158	0127  E8 FFA7			 call PUTCH
    159	012A  B2 C4			 mov dl	, '─'
    160	012C  E8 FFA2			 call PUTCH
    161	012F  B2 C5			 mov dl	, '┼'
    162	0131  E8 FF9D			 call PUTCH
    163	0134  B2 C4			 mov dl	, '─'
    164	0136  E8 FF98			 call PUTCH
    165	0139  B2 C4			 mov dl	, '─'
    166	013B  E8 FF93			 call PUTCH
    167	013E  B2 C4			 mov dl	, '─'
    168	0140  E8 FF8E			 call PUTCH
    169	0143  B2 C5			 mov dl	, '┼'
    170	0145  E8 FF89			 call PUTCH
    171	0148  B2 C4			 mov dl	, '─'
Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 4
lab.asm



    172	014A  E8 FF84			 call PUTCH
    173	014D  B2 C5			 mov dl	, '┼'
    174	014F  E8 FF7F			 call PUTCH
    175	0152  B2 C4			 mov dl	, '─'
    176	0154  E8 FF7A			 call PUTCH
    177	0157  B2 C4			 mov dl	, '─'
    178	0159  E8 FF75			 call PUTCH
    179	015C  B2 C4			 mov dl	, '─'
    180	015E  E8 FF70			 call PUTCH
    181	0161  B2 B4			 mov dl	, '┤'
    182	0163  E8 FF6B			 call PUTCH
    183	0166  E8 FF53			 call CLRF
    184	0169  C3			 ret
    185	016A			     PRNTSEPRTR	ENDP
    186				     ; -------------------------------
    187				     ; Печать шапки
    188	016A			     PRNTTAIL PROC
    189	016A  B2 C0			 mov dl	, '└'
    190	016C  E8 FF62			 call PUTCH
    191	016F  B2 C4			 mov dl	, '─'
    192	0171  E8 FF5D			 call PUTCH
    193	0174  B2 C1			 mov dl	, '┴'
    194	0176  E8 FF58			 call PUTCH
    195	0179  B2 C4			 mov dl	, '─'
    196	017B  E8 FF53			 call PUTCH
    197	017E  B2 C4			 mov dl	, '─'
    198	0180  E8 FF4E			 call PUTCH
    199	0183  B2 C4			 mov dl	, '─'
    200	0185  E8 FF49			 call PUTCH
    201	0188  B2 C1			 mov dl	, '┴'
    202	018A  E8 FF44			 call PUTCH
    203	018D  B2 C4			 mov dl	, '─'
    204	018F  E8 FF3F			 call PUTCH
    205	0192  B2 C1			 mov dl	, '┴'
    206	0194  E8 FF3A			 call PUTCH
    207	0197  B2 C4			 mov dl	, '─'
    208	0199  E8 FF35			 call PUTCH
    209	019C  B2 C4			 mov dl	, '─'
    210	019E  E8 FF30			 call PUTCH
    211	01A1  B2 C4			 mov dl	, '─'
    212	01A3  E8 FF2B			 call PUTCH
    213	01A6  B2 D9			 mov dl	, '┘'
    214	01A8  E8 FF26			 call PUTCH
    215	01AB  E8 FF0E			 call CLRF
    216	01AE  C3			 ret
    217	01AF			     PRNTTAIL ENDP
    218
    219				     END START
*Warning* lab.asm(213) Open segment: MYCODE
Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 5
Symbol Table




Symbol Name		Type   Value			   Cref	(defined at #)

??DATE			Text   "03/26/17"
??FILENAME		Text   "lab	"
??TIME			Text   "15:50:28"
??VERSION		Number 030A
@CPU			Text   0101H
@CURSEG			Text   MYCODE			   #2
@FILENAME		Text   LAB
@WORDSIZE		Text   2			   #2
CLRF			Near   MYCODE:00BC		   19  22  50  #85  95	151  183  215
CLRSCR			Near   MYCODE:00C7		   17  #94
CONTINUE		Near   MYCODE:008F		   52  #55
CURNTSMBL		Byte   MYCODE:0017		   #8  30  31  40  41  68
GETCH			Near   MYCODE:00DB		   58  #117
HEX			Near   MYCODE:009B		   35  45  #67
HEX_TABLE		Byte   MYCODE:0018		   #9  69
LABTITLE		Byte   MYCODE:0000		   #4  20
LOOPCH			Near   MYCODE:003F		   #27	54
PRNTHEAD		Near   MYCODE:00E0		   25  #124
PRNTSEPRTR		Near   MYCODE:0125		   53  #156
PRNTTAIL		Near   MYCODE:016A		   56  #188
PUTCH			Near   MYCODE:00D1		   29  32  34  37  39  42  44  47  49  87  89  #103  126  128  130  132	  +
							   134	136  138  140  142  144	 146  148  150	158  160  162  164  166	  +
							   168	170  172  174  176  178	 180  182  190	192  194  196  198  200	  +
							   202	204  206  208  210  212	 214
PUTSTR			Near   MYCODE:00D6		   21  #110
START			Near   MYCODE:0028		   #12	219

Groups & Segments	Bit Size Align	Combine	Class	   Cref	(defined at #)

MYCODE			16  01AF Para	none	CODE	   #2  3
Turbo Assembler	 Version 3.1	    03/26/17 15:50:28	    Page 6
Error Summary



*Warning* lab.asm(213) Open segment: MYCODE
