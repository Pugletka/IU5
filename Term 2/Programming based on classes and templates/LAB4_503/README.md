# Лабораторная работа №4

## Пункт 4.1. Создать в VS 2005 и руссифицировать консольный проект

Для создания консольного проекта необходимо: 
* Запустить систему программирования VS 2005; 
* В меню “File” выбрать пункт “New” и в подменю выбрать позицию “Project…”; 
* В списке “Project types” выбрать “Visual C++/Win32”, а в списке “Templates” выбрать “Win32 Console Application”;  
* В поле “Name” ввести: LAB1_XDD (где X – номер группы, а DD – номер варианта по журналу группы текущего семестра. Например, для студента группы ИУ5-22 с вариантом 15 – введем – LAB1_215). Далее нажать “OK”; 
* В новом окне мастера проектов нажать “Next”.  Проверить настройки проекта: “Application Type” должно быть – “Console Application”, “Additional option” -> “Empty Project” должен быть выключен, “Add common header files”-> “MFC”  и “ATL”  должны быть включены. 
* Далее необходимо нажать кнопку “Finish”. Новый проект будет создан. 
* Необходимо убрать из главных моделей проекта (LAB1_XDD.CPP и LAB1_XDD.H) все лишнее. Этого: в файле LAB1_XDD.H (у нас в примере LAB1_215.H) уберем все, а в файле LAB1_XDD.CPP (LAB1_215.CPP) оставим следующий текст: 

		#include "lab1_215.h" 
		#include <iostream> 
		
		using namespace std; 
		
		void main(void) 
		{ … } 
 
* Для контроля правильности создания пустого проекта, нажмем  клавишу “F7”   для проверки создания программы (build) и “F5” для проверки ее выполнения (run/debug). Все перечисленные действия должны быть выполнены безошибочно. Для правильной компиляции вместо многоточия нужно вставить любой корректный оператор. Например: 

		cout << "Проверка настройки проекта" << endl; 

Для корректного отображения текстов на русском языке и его ввода в окне командной строки (после первого запуска программы) нужно сделать настройки шрифта этого окна. Переключаем шрифт  в тип - Lucida Console. Выбираем настройки (после вывода консольного окна на экран, правой кнопкой вызываем системное меню): СВОЙСТВА->ШРИФТ -> Lucida Console). После переключения шрифта, на запрос в отдельном окошке нужно выбрать режим – “Для всех окон с данным именем!”. Для правильной русификации окна консоли, кроме этого, в самом начале главной программы нужно переключить кодовую страницу для вывода: 

		system(" chcp 1251 > nul"); 

Для приостановки завершения программы в консольном окне в конце ее работы можно вызвать паузу следующим образом (например, в конце текста программы): 

		system("PAUSE"); 

На экране появиться следующая строка (смотри ниже) и программа будет ожидать нажатия клавиши: 

		Для продолжения нажмите любую клавишу . . . 

Обратите внимание на то, что при другом способе локализации (setlocale(0,"rus");) не все работает правильно. Вывод на консоль и ввод с консоли выполняется правильно, но после этого введенные в консольном окне данные (например, строка) имеют другую кодировку и выводятся неверно! Можете сами это проверить. Поэтому предпочтительно использовать предложенный выше способ с переключением кодовой страницы. 

Примечание. Если вы затрудняетесь выполнить заданный пункт ЛР, обратитесь к разделу “Основные понятия”, где приведены примеры для иллюстрации данного пункта. 

Примечание. Все описания классов и шаблонов выполнять в заголовочном файле LAB1_XDD.H (у нас в примере LAB1_215.H). Описания объектов и вызов методов в основном файле: LAB1_XDD.CPP (LAB1_215.CPP). 

## Пункт 4.2. Варианты для выполнения заданий ЛР 

До начала выполнения ЛР необходимо познакомиться с таблицей вариантов для групп студентов (см. ниже) и выполнять задание следующих пунктов в соответствии со своим вариантом.  

## Пункт 4.3. Макрокоманды и переменные этапа компиляции

### МАКРОСЫ
 
Продемонстрировать в программе использование переменных этапа компиляции (переменная RAZM для массива и директива #define) и макрокоманд (директива #define). Организовать цикл суммирования по массиву с использованием переменной этапа компиляции (RAZM). Проверить использование макроса Swap из теоретического раздела. Создать свою макрокоманду и проверить ее использование. Тип и название макрокоманды определяется вариантом группы. Результат работы макроса для констант и переменных разного типа (int и float) распечатать в стандартный поток (cout).   

## Пункт 4.4. Шаблоны функции Swap 

### ШАБЛОН ФУНКЦИИ 

Создать шаблоны функции Swap (взаимный обмен) для параметров типа указатель и тип ссылка. Продемонстрировать применение шаблонов для двух типов переменных ( int и  double). Распечатать результат (cout), который может выглядеть таким образом: 

	Целый тип (указатель): 
	До Swap: x = 5 y = 10 
	После Swap:  x = 10 y = 5 
	Вещественный тип (указатель): 
	До Swap: d1 = 10.5 d2 = 5.5 
	После Swap:  d1 = 5.5 d2 = 10.5 
	Целый тип (ссылка): 
	До Swap: x = 5 y = 10 
	После Swap:  x = 10 y = 5 
	Вещественный тип (ссылка): 
	До Swap: d1 = 10.5 d2 = 5.5 
	После Swap:  d1 = 5.5 d2 = 10.5 

Показать в отладчике VS по шагам использование нужного шаблона для ссылок или указателей.  

Примечание. Имена классов и функций должны быть осмыслены. Целесообразно использовать “венгерскую” нотацию. При наследовании классов желательно пользоваться префиксами (Например, базовый шаблон - TRect, а класс наследник – DeriveRect, а шаблон шаблона TDeriveRect). Поля классов и методы тоже должны быть понятны. 

## Пункт 4.5. Шаблон функции с несколькими параметрами (сумма) 

### ШАБЛОН ФУНКЦИИ С ПАРАМЕТРАМИ 

Создать шаблон функции суммирования. Шаблон имеет два параметра: тип данных и целая переменная – размер массива (template <class T, int Razm  > … ). Первый параметр функции указатель на массив, в нем задается и тип массива для выполнения (T *). Второй параметр функции указатель на результат суммирования(T *). Размерность массива для вычисления функции передается при выполнении вызова функции (Например, Summ<int,5>(…)). Вызвать шаблонную функцию с разными типами параметров (int, float, double), с квалификацией типа функции и размера. Массивы описаны отдельно и проинициализированы при описании. Распечатать результат в поток (cout). Результат может быть, например, такого формата:  

	Сумма int = 15 
	Сумма float =  19.6 
	Сумма double =  15.6 

## Пункт 4.6. Специализация шаблона функции (д.т.) 

### СПЕЦИАЛИЗАЦИЯ ШАБЛОНА ФУНКЦИИ 

Продемонстрировать специализацию шаблона функции для типа char применительно к  вашей функции Swap для указателей (см. выше). В специализации шаблона для char выполняется  контроль одинаковых адресов, при этом выдается сообщение для демонстрации специализации. Продемонстрировать использование специализации шаблона. При совпадении выдать сообщение в консольное окно типа: 

	Одинаковые адреса! 

## Пункт 4.7. Шаблон класса с внутренними методами с одним параметром 

### ШАБЛОН КЛАССА

Создать шаблон для класса с одним параметром. Класс описывает тип, заданный вариантом группы (см. ниже список вариантов групп). Параметр шаблона задает тип координат (int, float, double). В классе описать метод распечатки (Print) и два конструктора (с параметрами и без). Помимо координат определить два свойства объекта: толщина линии и тип закраски (оба типа int). Добавить шаблон  методы изменения координат (Move) и задания типа закраски (SetFill). Все методы класса должны быть внутренними и открытыми (public). Описать три объекта нового типа для разных параметров настройки шаблона (int, float, double). Распечатать все объекты следующим образом (например, для прямоугольника): 

	Прямоугольник int (Прямоугольник один параметр): 
	Заполнение:5 
	Толщина линий: 4 
	x1 = 1  у1 = 2 
	x2 = 3  у2 = 4 

	Прямоугольник float (Прямоугольник один параметр): 
	Заполнение:3 
	Толщина линий: 4 
	x1 = 1.1  у1 = 2.1 
	x2 = 3.1  у2 = 4.1 

	Прямоугольник double (Прямоугольник один параметр) 
	Заполнение:3 
	Толщина линий: 4 
	x1 = 1.1  у1 = 2.1 
	x2 = 3.1  у2 = 4.1  

## Пункт 4.8. Шаблон класса с внутренними методами с двумя параметрами 
	
Создать шаблон класса с двумя параметрами. Второй параметр (типа int) задает начальные значения номера закраски объекта класса. Все остальные действия необходимо сделать аналогично предыдущему пункту задания и распечатать результат (например, для прямоугольника): 

	Прямоугольник int с начальной закраской (2 пар): 
	Заполнение:5 
	Толщина линий: 4 
	x1 = 1  у1 = 2 
	x2 = 3  у2 = 4 

## Пункт 4.9. Шаблон класса с внешними методами и двумя параметрами 

Для класса предыдущего пункта один из методов (Move) описать вне класса, указав настройки шаблона функции два параметра: тип координат и номер закраски. Описать объект и распечатать его (Print) результат для типа long (например, для прямоугольника): 

	Прямоугольник long с начальной закраской: 
	Заполнение:5 
	Толщина линий: 4 
	x1 = 1  у1 = 2 
	x2 = 3  у2 = 4 	

## Пункт 4.10. Описание нового класса на основе шаблона класса 

Описать класс наследник на основе шаблона класса предыдущего пункта (не шаблон!), который имеет переопределенный метод печати (Print) и настроен на конкретный тип базового шаблона (long). Переопределить грамотно 2 конструктора нового класса с корректным вызовом конструкторов базового класса. В новом классе описать новое свойство (член - данных), задающее цвет закраски фигуры ( FillColor типа int). Описать один объект этого класса, при этом использовать конструктор со всеми параметрами, и распечатать этот объект: 

	Прямоугольник long с начальной закраской: 
	Заполнение:5
	Цвет закраски:3 
	Толщина линий: 4 
	x1 = 1  у1 = 2 
	x2 = 3  у2 = 4 

## Пункт 4.11. Описание нового шаблона класса на основе шаблона класса 

На основе шаблона класса из предыдущих пунктов описать новый шаблон класса, в котором переопределен метод печати (Print) и добавлено свойство вид линий фигуры (LineType типа int). Описать три объекта на основе данного шаблона для разных типов (char, int и float). Распечатать все три объекта (Print): 

	Прямоугольник (шаблон TRect): 
	Заполнение:10 
	Толщина линий:1 
	Вид линий:3 
	x1 = 1  у1 = 1 
	x2 = 2  у2 = 2 

## Пункт 4.12. Задание нового типа на основе шаблона (typedef)  

Описать новый тип с помощью директивы typedef на основе шаблона класса. Напомню конструкцию директивы: 

	typedef  <старый тип или шаблон>  <новый тип>; 

В отличие от define здесь все наоборот! При квалификации шаблона использовать тип int. Описать объект нового типа и его распечатать: 

	Прямоугольник (шаблон TRect): 
	Заполнение:10 
	Толщина линий:1 
	Вид линий:3 
	x1 = 1  у1 = 1 
	x2 = 2  у2 = 2 

## Пункт 4.13. Описать шаблон класса для своего элементного класса КЛР (ДЗ) 
 
Для своего элементного класса ДЗ описать шаблон минимум с двумя параметрами настройки. Класс для ДЗ должен быть уже описан в ЛР №3 (см. варианты ДЗ/КЛР на сайте). Продемонстрировать описание и применение трех объектов и массива на основе этого шаблона. Результат описания поместить в отчет по ЛР и документацию проекта КЛР (ДЗ). Продемонстрировать печать объектов и его полей для разных типов. 

Примечание:  Для выбора параметров настройки шаблона выбирать числовые свойства (данные класса). Причем желательно, чтобы такие настройки были осмыслены. Если в своем классе трудно выделить параметры для настройки типа, то допускается добавить в класс искусственные переменные, которые могут потом не включаться в классы ДЗ. 

## Пункт 4.14. Описать шаблон класса для скелета своего контейнерного класса КЛР (ДЗ) 

Для своего контейнерного класса ДЗ описать шаблон с двумя параметрами настройки (см. варианты ДЗ/КЛР на сайте). Класс может быть представлен в виде скелетного описания (вместо методов и части данных можно использовать комментарии “//”) и должен быть наследован от класса список или массив (см. варианты ДЗ на сайте). Один параметр настройки шаблона должен определять разновидности контейнерного класса для наследования (из разных типов и библиотек для списков или массивов), а второй параметр может определять тип числового параметра своего контейнерного класса (например ограничение на объем контейнера или размер фонда зарплаты сотрудников). Продемонстрировать описание и инициализацию разных объектов на основе этого шаблона. Результат описания поместить в отчет по ЛР и документацию проекта КЛР (ДЗ). Продемонстрировать печать объекта для разных типов. 

Примечание:  Описание шаблона может быть учебным и не обязательно, в дальнейшем, использоваться в проекте ДЗ/КЛР. 

## Пункт 4.15. Построить диаграмму классов для наследования своих классов ДЗ (д.т.) 

Рекомендации по построению диаграммы классов приведены в разделе “диаграммы пользовательских классов”. 

Примечание: Если в заголовке текста задание указано (д.т. дополнительные требования) эти задания не являются обязательными и выполняются сильными студентами, о чем на титульном листе отчета делается специальная отметка – д.т.  

Примечание: Все действия по программированию и отладке выполняются студентом в интерактивном режиме с использованием отладчика.  

Примечание: После выполнения перечисленных действий студенты: демонстрируют работу программы преподавателю в отладчике, оформляют отчет на основе шаблона по лабораторной работе (см. приложение) и защищают ее, отвечая на контрольные вопросы представленные в данных методических указаниях. 

## Пункт 4.16. Дополнительные требования для сильных студентов 

Для сильных студентов предлагаются дополнительные требования при выполнении ЛР №4. Эти требования могут быть выполнены в любой последовательности и в любом объеме. На титульном листе отчета по ЛР необходимо указать, что дополнительные требования выполнены. Нужно: 

* Продемонстрировать использование шаблонов одного из классов STL (см. варианты). 
* Продемонстрировать специализацию шаблонов функций для своего варианта. 
* Продемонстрировать специализацию шаблонов класса для своего варианта. 
* Продемонстрировать применение шаблонных параметров классов. 
* Для геометрических координат объектов в заданиях изучить и применить стандартный класс CPoint (MFC). 
* Продемонстрировать задание глобального параметра для шаблона класса и функции. 
* Продемонстрировать использования классов MFC/ALT на выбор (типа массив или список) в качестве базового класса для шаблона. 
* Познакомиться с паттернами проектирования: синглет, посыльный, накопитель и команда. 

## Пункт 5. Варианты по группам и студентам  

Ниже предствалена таблица вариантов по группам студентов. В данной работе не назначаются индивидуальные варианты для каждого конкретного студента. 

| Вариант №  | Группа | Тип функции для шаблона | Тип класса для шаблона | Вид и название макроса | Тип класса STL - (д.т.) |
| -------------  | ------------- | ------------- | ------------- | ------------- | ------------- |
| 1 | ИУ5 – 21 | максимум | Треугольник | Min: минимум из трёх | string |
| 2 | ИУ5 – 22 | произведение | Линия | Max: максимум из трёх | vector |
| 3 | ИУ5 – 23 | минимум | Эллипс | Cmp: сравнение двух | stack |
| 4 | ИУ5 – 24 | сумма | Трапеция | Avr: среднее из трех | map |
| 5 | СУЦ | среднее | Окружность | Max: максимум из трёх | complex |

д.т – означает вариант для дополнительных требований. 

## Пункт 8. Контрольные вопросы к ЛР№4

1. Что такое проект в VS 2005? Для чего нужны проекты и в чем их преимущество? 
2. Дайте определение понятия макрокоманды (макроса). 
3. Дайте определение понятия переменной этапа компиляции. 
4. Что такое статическое связывание? 
5. Что такое динамическое связывание? 
6. Дайте определение понятия макроопределения. 
7. Дайте определение понятия макровызов. 
8. Дайте краткое определение понятия шаблона. 
9. Как описывается шаблон функции? 
10. Могут ли функции на основе шаблона вызываться без параметров? 
11. Можно ли задавать параметры шаблона функции по-умолчанию? 
12. Что такое инстанцирование шаблона? 
13. Что такое специализация шаблона функции? 
14. Что такое константный параметр шаблона? 
15. Как описывается шаблон класса? 
16. Можно ли задавать параметры шаблона класса по-умолчанию? 
17. Можно ли указывать пустой список фактических параметров шаблона класса при описании объектов? 
18. Как задаются шаблоны методов вне класса? 
19. Можно ли наследовать класс от шаблона класса? Как? 
20. Можно ли создать шаблон класса, на основе шаблона класса? Как? 
21. Что такое шаблонные параметры класса и как они описываются? 
22. Как описать новый тип с помощью typedef? 
23. Как задать ссылку параметра шаблона на глобальную переменную? 
24. Как выполнить специализацию шаблона класса? 
25. Какие библиотеки шаблонов и классов в MS VS вы знаете? 
26. Какие действия можно предпринять во время отладки программы с классами? 
 
